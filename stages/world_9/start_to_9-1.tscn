[gd_scene load_steps=23 format=4 uid="uid://d4ge1ria2yx4u"]

[ext_resource type="Script" uid="uid://bwpe24nufpj37" path="res://engine/scripts/classes/level_cutscene/level_cutscene.gd" id="1_uahoh"]
[ext_resource type="TileSet" uid="uid://dt1cibwye4su2" path="res://stages/world_9/Additives/9-2/9-2.tres" id="2_x5f0e"]
[ext_resource type="PackedScene" uid="uid://1do11cr84k7y" path="res://engine/objects/players/player.tscn" id="4_rwon7"]
[ext_resource type="Script" uid="uid://cugmax5psc2oo" path="res://engine/objects/players/player_camera_2d.gd" id="5_vh58w"]
[ext_resource type="PackedScene" uid="uid://yqftjpfskche" path="res://engine/components/cam_area/cam_area.tscn" id="6_x5f0e"]
[ext_resource type="Script" uid="uid://cphcaqumqow52" path="res://stages/world_9/Additives/9-1/darkness_top.gd" id="7_rwon7"]
[ext_resource type="Texture2D" uid="uid://v38jvaqe58dg" path="res://gfx/world9/waterfall/afternoon_bg.png" id="7_vh58w"]
[ext_resource type="Script" uid="uid://y6s8wmh6rlin" path="res://stages/world_9/Additives/cutscene_sky_scroll.gd" id="8_vh58w"]
[ext_resource type="PackedScene" uid="uid://et2504ye38n4" path="res://FX/leaves/leaves-falling.tscn" id="9_qt63m"]

[sub_resource type="GDScript" id="GDScript_x5f0e"]
script/source = "extends Node

@onready var player: Player = Thunder._current_player
@onready var jump_marker = $JumpMarker
var _player_speed: float = 150
var has_jumped: bool

func _ready() -> void:
	await get_parent().ready
	player = Thunder._current_player
	player.completed = true


func _physics_process(delta: float) -> void:
	player.speed.x = _player_speed
	
	if player.global_position.x > 360:
		_player_speed = move_toward(_player_speed, 100, delta * 80)
	
	if !has_jumped && player.global_position.x > jump_marker.global_position.x:
		player.jump(-500)
		var _sndfx: AudioStream = player.suit.physics_config.sound_jump[randi_range(0, len(player.suit.physics_config.sound_jump) - 1)]
		Audio.play_sound(_sndfx, player, false)
		has_jumped = true
	
	if player.global_position.y > 736:
		Scenes.current_scene._start_transition()
"

[sub_resource type="CanvasItemMaterial" id="CanvasItemMaterial_vh58w"]
blend_mode = 3

[sub_resource type="Gradient" id="Gradient_7ieye"]
offsets = PackedFloat32Array(0, 0.790224)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_qt63m"]
gradient = SubResource("Gradient_7ieye")
fill_from = Vector2(0, 1)
fill_to = Vector2(0, 0)

[sub_resource type="Curve" id="Curve_4yd1y"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.616216, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), -7.01374, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_k1x06"]
curve = SubResource("Curve_4yd1y")

[sub_resource type="Curve" id="Curve_v7alf"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="CurveTexture" id="CurveTexture_3xave"]
curve = SubResource("Curve_v7alf")

[sub_resource type="Curve" id="Curve_t48sc"]
_limits = [-1.0, 1.0, 0.0, 1.0]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.247826, 1), 0.0, 0.0, 0, 0, Vector2(0.5, -1), 0.0, 0.0, 0, 0, Vector2(0.752174, 0.743396), 0.0, 0.0, 0, 0, Vector2(1, -0.388679), 0.0, 0.0, 0, 0]
point_count = 5

[sub_resource type="CurveXYZTexture" id="CurveXYZTexture_5ytvc"]
curve_x = SubResource("Curve_t48sc")

[sub_resource type="Curve" id="Curve_o3v06"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.756757, 1), 0.0, 0.0, 0, 0, Vector2(1, 0.483516), -8.24177, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_tphpn"]
curve = SubResource("Curve_o3v06")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_fuxvd"]
particle_flag_disable_z = true
emission_shape_offset = Vector3(2240, -4, 0)
emission_shape = 3
emission_box_extents = Vector3(2240, 0, 1)
angle_min = -45.0
angle_max = 45.0
direction = Vector3(0, 1, 0)
initial_velocity_min = 50.0
initial_velocity_max = 100.0
directional_velocity_min = -1.0
directional_velocity_max = 1.0
directional_velocity_curve = SubResource("CurveXYZTexture_5ytvc")
gravity = Vector3(0, 0, 0)
scale_curve = SubResource("CurveTexture_tphpn")
alpha_curve = SubResource("CurveTexture_k1x06")
anim_offset_max = 1.0
anim_offset_curve = SubResource("CurveTexture_3xave")
collision_mode = 1
collision_friction = 1.0
collision_bounce = 0.0
collision_use_scale = true

[node name="StartTo9-1" type="Node2D"]
script = ExtResource("1_uahoh")
goto_path = "uid://b5latap6q3udv"
metadata/_custom_type_script = "uid://bwpe24nufpj37"

[node name="CutsceneLogic" type="Node" parent="."]
script = SubResource("GDScript_x5f0e")

[node name="JumpMarker" type="Marker2D" parent="CutsceneLogic"]
position = Vector2(352, 416)

[node name="Trees" type="TileMapLayer" parent="."]
z_index = 50
tile_map_data = PackedByteArray("AAAAAAYABQAEAAUAAAACAAUABQAEAAUAAAAEAAQABQAEAAUAAAAIAAQABQACAAUAAAAKAAUABQACAAUAAAAOAAUABQAEAAUAAAASAAUABQACAAUAAAATAAYABQACAAUAAAATAAUABQAHAAcAAAASAAQABQAHAAcAAAAKAAQABQAHAAcAAAAIAAMABQAHAAcAAAAAAAUABQAIAAcAAAACAAQABQAIAAcAAAAEAAMABQAIAAcAAAAOAAQABQAIAAcAAAAPAAQABQAJAAcAAAAQAAQABQAAAAYAAAARAAQABQAJAAcAAAANAAUABQAJAAcAAAAMAAUABQAAAAYAAAALAAUABQAJAAcAAAAJAAQABQAJAAcAAAAGAAMABQABAAYAAAAHAAMABQAJAAcAAAAFAAMABQAJAAcAAAADAAQABQAJAAcAAAABAAUABQAJAAcAAAAAAAAABQADAAQAAAAAAAEABQADAAQAAAAAAAIABQADAAQAAAABAAAABQADAAQAAAABAAEABQADAAQAAAABAAIABQADAAQAAAACAAAABQADAAQAAAACAAEABQADAAQAAAACAAIABQADAAQAAAADAAAABQADAAQAAAADAAEABQADAAQAAAADAAIABQADAAQAAAAEAAAABQADAAQAAAAEAAEABQADAAQAAAAEAAIABQADAAQAAAAFAAAABQADAAQAAAAFAAEABQADAAQAAAAFAAIABQADAAQAAAAGAAAABQADAAQAAAAGAAEABQADAAQAAAAGAAIABQADAAQAAAAHAAAABQADAAQAAAAHAAEABQADAAQAAAAHAAIABQADAAQAAAAIAAAABQADAAQAAAAIAAEABQADAAQAAAAIAAIABQADAAQAAAAJAAAABQADAAQAAAAJAAEABQADAAQAAAAJAAIABQADAAQAAAAKAAAABQADAAQAAAAKAAEABQADAAQAAAAKAAIABQADAAQAAAALAAAABQADAAQAAAALAAEABQADAAQAAAALAAIABQADAAQAAAAMAAAABQADAAQAAAAMAAEABQADAAQAAAAMAAIABQADAAQAAAANAAAABQADAAQAAAANAAEABQADAAQAAAANAAIABQADAAQAAAAOAAAABQADAAQAAAAOAAEABQADAAQAAAAOAAIABQADAAQAAAAPAAAABQADAAQAAAAPAAEABQADAAQAAAAPAAIABQADAAQAAAAQAAAABQADAAQAAAAQAAEABQADAAQAAAAQAAIABQADAAQAAAARAAAABQADAAQAAAARAAEABQADAAQAAAARAAIABQADAAQAAAASAAAABQADAAQAAAASAAEABQADAAQAAAASAAIABQADAAQAAAATAAAABQADAAQAAAATAAEABQADAAQAAAATAAIABQADAAQAAAAJAAMABQADAAQAAAAKAAMABQADAAQAAAALAAMABQADAAQAAAAMAAMABQADAAQAAAANAAMABQADAAQAAAAOAAMABQADAAQAAAAPAAMABQADAAQAAAAQAAMABQADAAQAAAARAAMABQADAAQAAAASAAMABQADAAQAAAATAAMABQADAAQAAAATAAQABQADAAQAAAANAAQABQADAAQAAAAMAAQABQADAAQAAAALAAQABQADAAQAAAADAAMABQADAAQAAAACAAMABQADAAQAAAABAAMABQADAAQAAAAAAAMABQADAAQAAAAAAAQABQADAAQAAAABAAQABQADAAQAAAAMAAYABQABAAcAAAAMAAcABQABAAcAAAAMAAgABQABAAcAAAAMAAkABQAAAAcAAAAMAAoABQABAAcAAAAMAAsABQABAAcAAAAMAAwABQABAAcAAAAMAA0ABQABAAcAAAAMAA4ABQABAAcAAAAQAAUABQABAAcAAAAQAAYABQABAAcAAAAQAAcABQABAAcAAAAQAAgABQAGAAYAAAAQAAkABQABAAcAAAAQAAoABQABAAcAAAAQAAsABQABAAcAAAAQAA4ABQABAAcAAAAQAAwABQABAAcAAAAQAA0ABQABAAcAAAAGAAQABQABAAcAAAAGAAUABQABAAcAAAAGAAYABQAAAAcAAAAGAAcABQABAAcAAAAGAAgABQABAAcAAAAGAAkABQABAAcAAAAGAAoABQAGAAYAAAAGAAsABQABAAcAAAAGAAwABQABAAcAAAAGAA0ABQABAAcAAAAGAA4ABQABAAcAAAARAAwABQAGAAUAAAAHAAYABQAFAAUAAAAFAAcABQAGAAUAAAADAAkABQAGAAUAAAABAAoABQAGAAUAAAABAAYABQAFAAUAAAABAAcABQAFAAUAAAABAAgABQAFAAUAAAABAAkABQAFAAUAAAADAAUABQAFAAUAAAADAAgABQAFAAUAAAADAAcABQAFAAUAAAADAAYABQAFAAUAAAAFAAYABQAFAAUAAAAFAAUABQAFAAUAAAAFAAQABQAFAAUAAAAHAAQABQAFAAUAAAAHAAUABQAFAAUAAAAJAAUABQAFAAUAAAAJAAYABQAFAAUAAAAJAAcABQAFAAUAAAAJAAgABQAFAAUAAAAJAAkABQAFAAUAAAAJAAoABQAFAAUAAAAJAAsABQAGAAUAAAALAAoABQAGAAUAAAANAAgABQAGAAUAAAALAAYABQAFAAUAAAALAAcABQAFAAUAAAALAAgABQAFAAUAAAALAAkABQAFAAUAAAANAAYABQAFAAUAAAANAAcABQAFAAUAAAAPAAUABQAFAAUAAAAPAAYABQAFAAUAAAAPAAcABQAFAAUAAAARAAUABQAFAAUAAAARAAYABQAFAAUAAAARAAcABQAFAAUAAAARAAgABQAFAAUAAAARAAkABQAFAAUAAAARAAoABQAFAAUAAAARAAsABQAFAAUAAAAPAAkABQAGAAUAAAAPAAgABQAFAAUAAAAHAA0ABQAGAAUAAAAHAAcABQAFAAUAAAAHAAgABQAFAAUAAAAHAAkABQAFAAUAAAAHAAoABQAFAAUAAAAHAAsABQAFAAUAAAAHAAwABQAFAAUAAAA=")
tile_set = ExtResource("2_x5f0e")

[node name="TreesDark" type="TileMapLayer" parent="."]
modulate = Color(0.412152, 0.412152, 0.412152, 1)
z_index = -2
tile_map_data = PackedByteArray("AAAFAAYABQACAAUAAAAHAAcABQACAAUAAAAKAAcABQAEAAUAAAAMAAYABQAEAAUAAAAPAAYABQACAAUAAAARAAcABQACAAUAAAATAAgABQACAAUAAAASAAcABQAAAAYAAAAQAAYABQADAAUAAAANAAUABQADAAUAAAAOAAUABQABAAYAAAALAAYABQADAAUAAAAJAAcABQADAAUAAAAIAAcABQAAAAYAAAAGAAYABQADAAUAAAAEAAUABQADAAUAAAADAAYABQAEAAUAAAAAAAcABQAEAAUAAAABAAYABQADAAUAAAACAAYABQAAAAYAAAAAAAYABQAIAAcAAAADAAUABQAIAAcAAAAKAAYABQAIAAcAAAAMAAUABQAIAAcAAAATAAcABQAHAAcAAAARAAYABQAHAAcAAAAPAAUABQAHAAcAAAAHAAYABQAHAAcAAAAFAAUABQAHAAcAAAAEAAMABQADAAQAAAAEAAQABQADAAQAAAADAAQABQADAAQAAAACAAQABQADAAQAAAACAAUABQADAAQAAAABAAUABQADAAQAAAAAAAUABQADAAQAAAAFAAQABQADAAQAAAAFAAMABQADAAQAAAAGAAMABQADAAQAAAAGAAQABQADAAQAAAAGAAUABQADAAQAAAAHAAUABQADAAQAAAAHAAQABQADAAQAAAAHAAMABQADAAQAAAAIAAQABQADAAQAAAAIAAUABQADAAQAAAAIAAYABQADAAQAAAAIAAMABQADAAQAAAAJAAQABQADAAQAAAAJAAUABQADAAQAAAAJAAYABQADAAQAAAAKAAUABQADAAQAAAALAAUABQADAAQAAAALAAQABQADAAQAAAAKAAQABQADAAQAAAAPAAQABQADAAQAAAAOAAQABQADAAQAAAAQAAQABQADAAQAAAAQAAUABQADAAQAAAARAAUABQADAAQAAAASAAUABQADAAQAAAASAAQABQADAAQAAAARAAQABQADAAQAAAASAAYABQADAAQAAAATAAYABQADAAQAAAATAAUABQADAAQAAAAOAAYABQABAAcAAAAOAAcABQABAAcAAAAOAAgABQAAAAcAAAAOAAkABQABAAcAAAAOAAoABQABAAcAAAAOAAsABQABAAcAAAAOAAwABQABAAcAAAAOAA0ABQABAAcAAAAOAA4ABQABAAcAAAASAAgABQABAAcAAAASAAkABQABAAcAAAASAAoABQAGAAYAAAASAAsABQABAAcAAAASAAwABQABAAcAAAAIAAgABQABAAcAAAAIAAkABQABAAcAAAAIAAoABQABAAcAAAACAAcABQAAAAcAAAACAAgABQABAAcAAAA=")
tile_set = ExtResource("2_x5f0e")

[node name="TileMapLayer" type="TileMapLayer" parent="."]
tile_map_data = PackedByteArray("AAAKAA8AAQABAAIAAAAKAA4AAQABAAEAAAAKAA0AAQABAAAAAAAJAA8AAQABAAIAAAAJAA4AAQABAAEAAAAJAA0AAQAFAAEAAAAIAA8AAQABAAIAAAAIAA4AAQABAAEAAAAIAA0AAQABAAEAAAAHAA8AAQABAAIAAAAHAA4AAQABAAEAAAAHAA0AAQABAAEAAAAGAA8AAQABAAIAAAAGAA4AAQABAAEAAAAGAA0AAQABAAEAAAAFAA8AAQABAAIAAAAFAA4AAQABAAEAAAAFAA0AAQABAAEAAAAEAA8AAQABAAIAAAAEAA4AAQABAAEAAAAEAA0AAQABAAEAAAADAA8AAQABAAIAAAADAA4AAQABAAEAAAADAA0AAQABAAEAAAACAA8AAQABAAIAAAACAA4AAQABAAEAAAACAA0AAQABAAEAAAABAA8AAQABAAIAAAABAA4AAQABAAEAAAABAA0AAQABAAEAAAAAAA8AAQABAAIAAAAAAA4AAQABAAEAAAAAAA0AAQABAAEAAAD//w8AAQAAAAIAAAD//w4AAQAAAAEAAAD//w0AAQAAAAEAAAAUAA8AAQACAAIAAAAUAA4AAQACAAEAAAAUAA0AAQACAAAAAAATAA8AAQABAAIAAAATAA4AAQABAAEAAAATAA0AAQABAAAAAAASAA8AAQAAAAIAAAASAA4AAQAAAAEAAAASAA0AAQAAAAAAAAD//wwAAQAAAAEAAAAAAAwAAQABAAEAAAABAAwAAQABAAEAAAACAAwAAQABAAEAAAADAAwAAQABAAEAAAAEAAwAAQABAAEAAAAEAAsAAQABAAAAAAADAAsAAQAFAAEAAAACAAsAAQABAAEAAAABAAsAAQABAAEAAAAAAAsAAQABAAEAAAD//wsAAQAAAAEAAAAFAAwAAQABAAEAAAAGAAwAAQABAAEAAAAGAAsAAQABAAAAAAAFAAsAAQABAAAAAAAHAAsAAQABAAAAAAAHAAwAAQABAAEAAAAIAAwAAQAFAAEAAAAIAAsAAQACAAAAAAABAAkAAQABAAAAAAAAAAkAAQABAAAAAAD//wkAAQAAAAAAAAD//woAAQAAAAEAAAAAAAoAAQABAAEAAAABAAoAAQABAAEAAAACAAoAAQAFAAEAAAALAA0AAQABAAAAAAALAA4AAQABAAEAAAALAA8AAQABAAIAAAAMAA8AAQABAAIAAAAMAA4AAQABAAEAAAAMAA0AAQABAAAAAAANAA4AAQACAAEAAAANAA8AAQACAAIAAAANAA0AAQACAAAAAAACAAkAAQACAAAAAAADAAkAAAABAAAAAAAEAAoAAAABAAAAAAAJAAsAAAABAAAAAAAKAAwAAAABAAAAAAADAAoAAQACAAAAAAAJAAwAAQACAAAAAAA=")
tile_set = ExtResource("2_x5f0e")
metadata/_edit_lock_ = true

[node name="Player" parent="." instance=ExtResource("4_rwon7")]
position = Vector2(0, 272)
gravity_dir = Vector2(0, 0.3)

[node name="PlayerCamera2D" type="Camera2D" parent="."]
position = Vector2(320, 240)
script = ExtResource("5_vh58w")
metadata/_custom_type_script = "uid://cugmax5psc2oo"

[node name="CameraArea" parent="." instance=ExtResource("6_x5f0e")]
z_index = 100
offset_right = 640.0
offset_bottom = 480.0
metadata/_edit_lock_ = true

[node name="DarknessBottom" type="Sprite2D" parent="."]
z_index = 51
material = SubResource("CanvasItemMaterial_vh58w")
position = Vector2(320, 454)
scale = Vector2(10, 0.812499)
texture = SubResource("GradientTexture2D_qt63m")
script = ExtResource("7_rwon7")

[node name="TextureRect" type="TextureRect" parent="."]
z_index = -100
offset_top = 36.0
offset_right = 800.0
offset_bottom = 480.0
texture = ExtResource("7_vh58w")
stretch_mode = 1
script = ExtResource("8_vh58w")
metadata/_edit_lock_ = true

[node name="Leaves-falling" parent="." instance=ExtResource("9_qt63m")]
z_index = 20
amount = 200
preprocess = 10.0
visibility_rect = Rect2(0, 0, 640, 480)
process_material = SubResource("ParticleProcessMaterial_fuxvd")
